//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// 
///////////////////////////////////////              Import das Bibliotecas               /////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// 
const express = require('express');
const dotenv = require('dotenv').config({path:'./.env'});
const mysql = require('mysql');
const path = require('path');
const app = express();



app.set('view engine', 'hbs'); // Use hbs instead of html
app.set("index","./views"); // view folder contain .hbs files


const publicDirectory = path.join(__dirname, './assets');
app.use(express.static(publicDirectory));

app.use(express.urlencoded({ extended: false }));
app.use(express.json())


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// 
///////////////////////////////////////              ´Base de Dados            /////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//Create connection

const db = mysql.createConnection({
  host:process.env.DATABASE_HOST,
  port:process.env.DATABASE_PORT,
  user:process.env.DATABASE_USER,
  password: process.env.DATABASE_PASSWORD,
  database: process.env.DATABASE
});




  // Connect DataBase
  db.connect(function(err) {
    if (err) {throw err};
    console.log("Connected!");
  });
  
  


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// 
///////////////////////////////////////              ´ROTAS            /////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// 


app.use(require('./routes'))
app.use(require('./routes/auth'))



//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// 
///////////////////////////////////////              LIGACAO AO SERVIDOR            ////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// 
const PORT = process.env.PORT || 3000;

app.listen(PORT || 3000, () => { 
   console.log(`listening on *: ${PORT}`);
});


